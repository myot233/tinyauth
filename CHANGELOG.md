# TinyAuth 更新日志

## 最新更新 - 大屏幕提示功能

### 新增功能：管理员操作大屏幕提示
- **新增**: 玩家被管理员登出时显示大屏幕标题提示
- **新增**: 玩家账号被管理员注销时显示大屏幕标题提示
- **配置项**:
  - `logoutTitleText`: 被登出时的大标题文本 (默认: "§c§l账号已登出")
  - `logoutSubtitleText`: 被登出时的副标题文本 (默认: "§e你的账号已被管理员强制登出")
  - `removeTitleText`: 账号被注销时的大标题文本 (默认: "§4§l账号已注销")
  - `removeSubtitleText`: 账号被注销时的副标题文本 (默认: "§c你的账号已被管理员注销")

### 功能特点
- **醒目提示**: 使用Minecraft原生Title API显示大屏幕提示
- **自定义文本**: 管理员可以在配置文件中自定义提示文本
- **颜色支持**: 支持Minecraft颜色代码和格式代码
- **动画效果**: 标题具有淡入淡出动画效果（淡入1秒，停留3秒，淡出1秒）

## 之前的功能

### 1. IPv6支持优化
- **修复**: 审计界面IPv6地址显示不全的问题
- **改进**: IP地址解析逻辑，完整保留IPv6格式
- **优化**: 审计界面显示格式，使用颜色代码提升可读性

### 2. IP登录限制功能
- **新增**: IP白名单系统，支持IPv4和IPv6
- **配置项**:
  - `enableIPRestriction`: 是否启用IP登录限制 (默认: false)
  - `maxAllowedIPs`: 每个账号允许的最大IP数量 (默认: 3)
  - `ipRestrictedMessage`: IP受限时的提示消息
- **功能**:
  - 首次注册/登录时自动添加当前IP到白名单
  - 超出IP限制时阻止登录
  - 管理员可以管理玩家的IP白名单

### 3. 登录成功延迟消息和命令
- **新增**: 登录成功后延迟发送自定义消息
- **新增**: 登录成功后延迟执行自定义命令
- **配置项**:
  - `loginDelayTicks`: 延迟时间（游戏刻，默认: 60）
  - `loginDelayMessage`: 延迟发送的消息
  - `loginDelayCommand`: 延迟执行的命令（支持%player%占位符）

### 4. 管理员命令

#### IP管理命令
- `/auth ip list <玩家>` - 查看玩家的允许IP列表
- `/auth ip add <玩家> <IP>` - 为玩家添加允许的IP
- `/auth ip remove <玩家> <IP>` - 移除玩家的允许IP
- `/auth ip clear <玩家>` - 清空玩家的IP白名单

#### 现有命令优化
- `/auth logout <玩家>` - 登出玩家（现在带有大屏幕提示）
- `/auth remove <玩家>` - 注销玩家账号（现在带有大屏幕提示）
- `/auth audit <玩家>` - 审计界面显示优化，支持完整IPv6显示

## 配置文件示例

```toml
[auth_settings]
    # 密码规则
    pwdMatch = "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[\\W_])[^\\s]{8,}$"
    pwdMatchError = "§r密码必须包含至少一个小写字母、一个大写字母、一个数字、一个特殊字符（包括下划线），不能有空格，且长度至少为8位。"
    
    # 消息间隔和超时
    tickPerMsg = 300
    timeOutTick = 3000
    timeoutKickMessage = "§c登录超时，请重新连接服务器"
    
    # IP限制功能
    enableIPRestriction = false
    maxAllowedIPs = 3
    ipRestrictedMessage = "§c此账号已达到IP登录限制，请联系管理员"
    
    # 延迟消息和命令
    loginDelayTicks = 60
    loginDelayMessage = "§a欢迎回来！祝你游戏愉快！"
    loginDelayCommand = "say 欢迎 %player% 回到服务器！"
    
    # 大屏幕提示配置
    logoutTitleText = "§c§l账号已登出"
    logoutSubtitleText = "§e你的账号已被管理员强制登出"
    removeTitleText = "§4§l账号已注销"
    removeSubtitleText = "§c你的账号已被管理员注销"
```

## 使用说明

### 自定义大屏幕提示
在配置文件中可以自定义提示文本：

```toml
# 登出提示
logoutTitleText = "§c§l⚠ 强制登出 ⚠"
logoutSubtitleText = "§e管理员已将你登出，请重新登录"

# 注销提示  
removeTitleText = "§4§l❌ 账号注销 ❌"
removeSubtitleText = "§c你的账号已被永久注销"
```

### 颜色代码参考
- `§0` - 黑色
- `§1` - 深蓝色
- `§2` - 深绿色
- `§3` - 深青色
- `§4` - 深红色
- `§5` - 深紫色
- `§6` - 金色
- `§7` - 灰色
- `§8` - 深灰色
- `§9` - 蓝色
- `§a` - 绿色
- `§b` - 青色
- `§c` - 红色
- `§d` - 紫色
- `§e` - 黄色
- `§f` - 白色

### 格式代码
- `§l` - 粗体
- `§m` - 删除线
- `§n` - 下划线
- `§o` - 斜体
- `§r` - 重置格式

## 效果展示

当管理员执行 `/auth logout <玩家>` 时：
- 玩家屏幕中央会显示大标题："**账号已登出**"（红色粗体）
- 下方显示副标题："你的账号已被管理员强制登出"（黄色）
- 标题会有淡入淡出动画效果
- 同时玩家会被切换到观察者模式

当管理员执行 `/auth remove <玩家>` 时：
- 玩家屏幕中央会显示大标题："**账号已注销**"（深红色粗体）
- 下方显示副标题："你的账号已被管理员注销"（红色）
- 玩家的所有认证数据会被清除

## 注意事项

1. **视觉冲击**: 大屏幕提示具有强烈的视觉效果，能有效提醒玩家
2. **自定义配置**: 服务器管理员可以根据需要自定义提示文本
3. **多语言支持**: 配置文件支持任何语言的文本
4. **兼容性**: 使用Minecraft原生API，兼容性良好 